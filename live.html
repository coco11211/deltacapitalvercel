<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live Dashboard</title>
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" type="image/svg+xml" href="/img/favicon.svg">
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png">
  <link rel="manifest" href="/img/manifest.json">
  <meta name="theme-color" content="#111111">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0e27;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .login-container {
      display: none;
      background: #1a1f3a;
      border: 1px solid #2a2f4a;
      border-radius: 8px;
      padding: 40px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    .login-container.active {
      display: block;
    }

    .login-container h1 {
      font-size: 28px;
      font-weight: 300;
      margin-bottom: 30px;
      text-align: center;
      letter-spacing: -0.01em;
    }

    .login-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-group label {
      font-size: 14px;
      color: #aaa;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .form-group input {
      padding: 12px 16px;
      background: #0a0e27;
      border: 1px solid #2a2f4a;
      border-radius: 4px;
      color: #fff;
      font-size: 16px;
      transition: border-color 0.3s;
    }

    .form-group input:focus {
      outline: none;
      border-color: #4a6fa5;
    }

    .form-group input::placeholder {
      color: #666;
    }

    .login-button {
      padding: 12px 16px;
      background: #2a5a7a;
      border: 1px solid #3a7aaa;
      border-radius: 4px;
      color: #fff;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .login-button:hover {
      background: #3a7aaa;
      border-color: #4a9aca;
    }

    .login-button:active {
      transform: translateY(1px);
    }

    .error-message {
      display: none;
      padding: 12px;
      background: #3a1a1a;
      border: 1px solid #6a3a3a;
      border-radius: 4px;
      color: #ff6b6b;
      font-size: 14px;
      text-align: center;
    }

    .error-message.show {
      display: block;
    }

    .dashboard-container {
      display: none;
      width: 100%;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      background: #0a0e27;
    }

    .dashboard-container.active {
      display: flex;
    }

    .dashboard-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: rgba(10, 14, 39, 0.95);
      border-bottom: 1px solid #2a2f4a;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 30px;
      z-index: 100;
    }

    .dashboard-title {
      font-size: 18px;
      font-weight: 500;
      letter-spacing: 0.02em;
    }

    .logout-button {
      padding: 8px 16px;
      background: #3a2a2a;
      border: 1px solid #5a3a3a;
      border-radius: 4px;
      color: #ff6b6b;
      font-size: 13px;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      transition: all 0.3s;
    }

    .logout-button:hover {
      background: #5a3a3a;
      border-color: #7a4a4a;
    }

    .dashboard-iframe {
      width: 100%;
      height: 100%;
      border: none;
      margin-top: 60px;
    }

    @media (max-width: 600px) {
      .login-container {
        padding: 30px 20px;
      }

      .login-container h1 {
        font-size: 22px;
        margin-bottom: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- Login Form -->
  <div class="login-container active" id="loginContainer">
    <h1>Live Dashboard</h1>
    <form class="login-form" onsubmit="handleLogin(event)">
      <div class="form-group">
        <label for="password">Password</label>
        <input
          type="password"
          id="password"
          placeholder="Enter password"
          autocomplete="off"
          required
        />
      </div>
      <button type="submit" class="login-button">Access Dashboard</button>
      <div class="error-message" id="errorMessage"></div>
    </form>
  </div>

  <!-- Dashboard -->
  <div class="dashboard-container" id="dashboardContainer">
    <div class="dashboard-header">
      <div class="dashboard-title">Delta Capital Live Trading</div>
      <button class="logout-button" onclick="handleLogout()">Logout</button>
    </div>
    <iframe
      class="dashboard-iframe"
      id="dashboardFrame"
      src=""
      allow="fullscreen"
    ></iframe>
  </div>

  <script>
    // Configuration
    const PASSWORD = 'k@tie';
    const DASHBOARD_URL = 'https://www.quantconnect.cloud/live/28087125/73a208f192074f466917c1137ea19ae9eece9966096d5252f8f068eb0705d934/?theme=chrome';
    const AUTH_KEY = 'dc_live_auth';
    const SESSION_TIMEOUT = 24 * 60 * 60 * 1000; // 24 hours

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      checkAuth();

      // Check auth status periodically
      setInterval(checkAuth, 60000); // Every minute
    });

    function checkAuth() {
      const auth = localStorage.getItem(AUTH_KEY);

      if (auth) {
        const authData = JSON.parse(auth);
        const now = Date.now();

        // Check if session is still valid
        if (now - authData.timestamp < SESSION_TIMEOUT) {
          showDashboard();
          return;
        } else {
          // Session expired
          localStorage.removeItem(AUTH_KEY);
        }
      }

      showLogin();
    }

    function handleLogin(event) {
      event.preventDefault();

      const passwordInput = document.getElementById('password');
      const password = passwordInput.value;
      const errorMessage = document.getElementById('errorMessage');

      // Clear previous error
      errorMessage.classList.remove('show');

      // Verify password
      if (password === PASSWORD) {
        // Store authentication
        const authData = {
          timestamp: Date.now(),
          token: btoa(PASSWORD + Date.now())
        };
        localStorage.setItem(AUTH_KEY, JSON.stringify(authData));

        // Clear input
        passwordInput.value = '';

        // Show dashboard
        showDashboard();
      } else {
        // Show error
        errorMessage.textContent = 'Invalid password. Please try again.';
        errorMessage.classList.add('show');
        passwordInput.value = '';
        passwordInput.focus();
      }
    }

    function showDashboard() {
      const loginContainer = document.getElementById('loginContainer');
      const dashboardContainer = document.getElementById('dashboardContainer');
      const dashboardFrame = document.getElementById('dashboardFrame');

      loginContainer.classList.remove('active');
      dashboardContainer.classList.add('active');

      // Load iframe
      if (!dashboardFrame.src) {
        dashboardFrame.src = DASHBOARD_URL;
      }
    }

    function showLogin() {
      const loginContainer = document.getElementById('loginContainer');
      const dashboardContainer = document.getElementById('dashboardContainer');

      loginContainer.classList.add('active');
      dashboardContainer.classList.remove('active');
    }

    function handleLogout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem(AUTH_KEY);
        document.getElementById('password').value = '';
        showLogin();
        document.getElementById('password').focus();
      }
    }

    // Prevent direct access to dashboard frame
    window.addEventListener('beforeunload', function() {
      checkAuth();
    });

    // Keyboard shortcut: Escape to logout (optional)
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape' && document.getElementById('dashboardContainer').classList.contains('active')) {
        if (confirm('Logout?')) {
          handleLogout();
        }
      }
    });
  </script>

  <script src="/js/cookie-notice.js"></script>
</body>
</html>
